<div class="flex flex-col space-y-4 p-4">
  <!-- Loading Spinner -->
  @if (loading) {
  <div class="flex justify-center">
    <p-progressSpinner></p-progressSpinner>
  </div>
  }

  <!-- Main Content -->
  @if (!loading && book) {
  <div class="bg-white shadow rounded-lg p-6">
    <!-- Basic Info Section -->
    <fieldset class="border border-gray-300 p-4 rounded">
      <legend class="text-lg font-semibold">Basic Information</legend>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-center">
        <div>
          <img
            [src]="book.coverUrl || 'assets/default-book-cover.png'"
            alt="Book Cover"
            class="w-full rounded-lg shadow"
          />
        </div>
        <div class="md:col-span-2">
          <h1 class="text-2xl font-bold">{{ book.title }}</h1>
          <h3 class="text-gray-600">{{ book.authors.join(", ") }}</h3>

          <div class="mt-3 flex space-x-2">
            <span class="px-3 py-1 bg-gray-100 rounded-full text-sm font-medium"
              >ISBN: {{ book.isbn }}</span
            >
            <span class="px-3 py-1 bg-gray-100 rounded-full text-sm font-medium"
              >Year: {{ book.publicationYear }}</span
            >
            <span
              class="px-3 py-1 bg-gray-100 rounded-full text-sm font-medium"
              >{{ book.category }}</span
            >
            <span
              class="px-3 py-1 rounded-full text-sm font-medium"
              [ngClass]="
                book.available
                  ? 'bg-green-100 text-green-600'
                  : 'bg-red-100 text-red-600'
              "
            >
              {{ book.available ? "Available" : "Checked Out" }}
            </span>
          </div>
        </div>
      </div>
    </fieldset>

    <!-- Loan History Section -->
    <fieldset class="border border-gray-300 p-4 rounded mt-4">
      <legend class="text-lg font-semibold">Loan History</legend>
      <div class="space-y-3">
        @for (event of loanHistory; track event) {
        <div class="flex justify-between items-center border-b pb-2">
          <span class="text-sm font-semibold">{{ event.user }}</span>
          <span class="text-gray-600">{{ event.userType | titlecase }}</span>
          <span class="text-gray-500 text-xs"
            >{{ event.date | date : "mediumDate" }} - {{ event.status }}</span
          >
        </div>
        }
      </div>
    </fieldset>
  </div>
  }

  <!-- Quick Actions Sidebar -->
  @if (!loading) {
  <div class="bg-white shadow rounded-lg p-6">
    <h3 class="text-lg font-semibold mb-4">Quick Actions</h3>
    <button
      class="w-full bg-blue-500 text-white py-2 rounded-lg shadow hover:bg-blue-600 mb-2"
      [disabled]="!book?.available"
      (click)="checkOutBook()"
    >
      Check Out
    </button>
    <button
      class="w-full bg-yellow-500 text-white py-2 rounded-lg shadow hover:bg-yellow-600 mb-2"
      (click)="markAsDamaged()"
    >
      Mark as Damaged
    </button>
    <button
      class="w-full bg-gray-500 text-white py-2 rounded-lg shadow hover:bg-gray-600"
      (click)="navigateToEdit()"
    >
      Edit Details
    </button>
  </div>
  }
</div>
